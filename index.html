<script>
  // Inicialização do autocomplete Photon (já está no seu projeto)
  const input = document.getElementById('busca-endereco');
  const mapTarget = document.getElementById('map');

  const searchControl = new PhotonAddressAutoComplete(input, {
    lang: 'pt',
    limit: 5,
    placeholder: 'Buscar endereço...',
    noResultLabel: 'Nenhum resultado encontrado'
  });

  searchControl.on('selected', function (feature) {
    if (feature && feature.geometry && feature.geometry.coordinates) {
      const lon = feature.geometry.coordinates[0];
      const lat = feature.geometry.coordinates[1];
      
      // Transforma para a projeção do OpenLayers (se necessário)
      const coord = ol.proj.fromLonLat([lon, lat]);

      // Move o mapa
      map.getView().animate({ center: coord, zoom: 16 });

      // Adiciona marcador (opcional)
      const marker = new ol.Feature({
        geometry: new ol.geom.Point(coord)
      });

      const vectorSource = new ol.source.Vector({ features: [marker] });
      const markerLayer = new ol.layer.Vector({
        source: vectorSource,
        style: new ol.style.Style({
          image: new ol.style.Circle({
            radius: 6,
            fill: new ol.style.Fill({ color: 'red' }),
            stroke: new ol.style.Stroke({ color: '#fff', width: 2 })
          })
        })
      });

      // Remove camadas anteriores de marcador, se quiser
      map.getLayers().getArray().forEach(layer => {
        if (layer.get('name') === 'buscaEndereco') {
          map.removeLayer(layer);
        }
      });

      markerLayer.set('name', 'buscaEndereco');
      map.addLayer(markerLayer);
    }
  });
</script>
